{% extends "tournament/base.html" %}

{% block content %}
<div class="board" style="max-width: 800px; margin: 40px auto; color: white;">
    
    <div style="display:flex; justify-content:space-between; align-items:center; border-bottom: 2px solid #3b82f6; padding-bottom: 20px; margin-bottom: 30px;">
        <h1 style="margin:0;">ğŸ‘¤ Captain's Portal: {{ team.name }}</h1>
        
        <div style="display: flex; gap: 10px;">
            <a href="{% url 'fixtures' %}" class="btn" style="background: #6366f1;">ğŸ‘ï¸ View Live Scores</a>
            <a href="{% url 'logout' %}" class="btn" style="background:#ef4444;">Logout</a>
        </div>
    </div>

    {% if messages %}
    <div style="background: #22c55e; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
        {% for message in messages %}{{ message }}{% endfor %}
    </div>
    {% endif %}

    <h2 style="color: #94a3b8;">Pending Matches</h2>

    {% for m in matches %}
    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
        
        <div>
            <div style="color: #3b82f6; font-weight: 800; font-size: 14px; text-transform: uppercase; margin-bottom: 5px;">
                {{ m.event.sport.name }} // {{ m.event.name }}
            </div>
            <div style="font-size: 18px; font-weight: 700;">
                {# Determine Opponent #}
                vs 
                {% if m.team1 == team %}
                    {{ m.team2.name|default:m.opponent_rule }}
                {% else %}
                    {{ m.team1.name|default:m.opponent_rule }}
                {% endif %}
            </div>
            <div style="font-size: 13px; opacity: 0.7; margin-top: 5px;">
                ğŸ“… {{ m.date|date:"M j" }} &nbsp; â° {{ m.time|time:"H:i" }}
            </div>
            
            {% if m.team1 == team and m.team1_players %}
                <div style="margin-top: 10px; font-size: 14px; color: #22c55e;">âœ… Squad: {{ m.team1_players }}</div>
            {% elif m.team2 == team and m.team2_players %}
                <div style="margin-top: 10px; font-size: 14px; color: #22c55e;">âœ… Squad: {{ m.team2_players }}</div>
            {% else %}
                <div style="margin-top: 10px; font-size: 14px; color: #fbbf24;">âš ï¸ Squad not selected</div>
            {% endif %}
        </div>

        <a href="{% url 'select_squad' m.id %}" class="btn">Select Squad</a>
    </div>
    {% empty %}
    <div style="text-align: center; padding: 40px; opacity: 0.5;">
        <p>No upcoming matches found for {{ team.name }}.</p>
    </div>
    {% endfor %}

</div>
{% endblock %}